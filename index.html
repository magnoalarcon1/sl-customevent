<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sendlane Custom Events POC</title>

    <!-- Sendlane Configuration -->
    <script>
        // Configuration - Update these values as needed
        const SENDLANE_DATA_TOKEN = 'db9ab736-afaf-42f4-af04-695828a31bda';  // Beacon data-token
        const BEACON_EVENT_ID = 'lkfolewnIGEQi';    // Beacon event_id
        const CUSTOM_EVENT_NAME = 'event_1234';     // Custom event name
    </script>

    <!-- Sendlane Beacon Installation (Following woodworkerssource pattern) -->
    <script>
        
    </script>
    <script>
        // Create and configure pusher script with data-token
        const script = document.createElement('script');
        script.src = 'https://sendlane.com/scripts/pusher.js';
        script.async = true;
        script.setAttribute('data-token', SENDLANE_DATA_TOKEN);
        document.head.appendChild(script);
        window._Sendlane = window._Sendlane || [];
        // Initialize Beacon
        _Sendlane.push({
            event_id: BEACON_EVENT_ID
        });
    </script>

    <!-- Custom Event Functions -->
    <script>

        function sendCustomEvent() {
            const email = document.getElementById('email').value;

            if (!email) {
                alert('Please enter an email');
                return;
            }

            console.log('ðŸ“§ Starting contact identification and standard event for:', email);

            // STEP 1: Identify contact (REQUIRED per Sendlane docs)
            _Sendlane.push({
                "event": "identify",
                "email": email
            });
            console.log('ðŸ†” Contact identified');

            // STEP 2: Send standard event after identification (using JavaScript API available events)
            setTimeout(() => {
                _Sendlane.push({
                    "event": "product_viewed",  // Standard event that works with JavaScript API
                    "email": email,
                    "product_id": "poc-test-001",
                    "first_name": "poc-test-name",
                    "last_name": "poc-test-lastname"
                });
                console.log('âœ… Standard event (product_viewed) sent');
                alert('Contact identified and standard event sent for ' + email);
            }, 500); // Small delay to ensure identification processes first
        }
    </script>
</head>
<body>
    <h1>Sendlane Custom Events POC</h1>
    <p>Proof of concept to send custom fields using custom events</p>

    <div>
        <label for="email">Email:</label>
        <input type="email" id="email" placeholder="example@email.com">
        <button onclick="sendCustomEvent()">Send Custom Event</button>
    </div>
</body>
</html>